\section{はじめに}
\label{section:algebraic effects__intro}

プログラムのある時点での残りの計算のことを「継続」という。
たとえばプログラム \texttt{1 + (2 + 4)} の \texttt{2 + 4} を計算している時点での
継続は「今の計算の結果を \texttt{1} に足す」という計算である。
継続のうち一部を切り取った計算を限定継続という。
\ref{chapter:try-with} 章で扱った例外処理機能 try-with は、
「例外が起きたらその時点での継続のうち try までの限定継続を捨てる」
ものだといえる。
一方、shift/reset \cite{DF1990} や algebraic effects \cite{PRETNAR201519}
といった言語機能では、継続を関数のようなものとして変数に束縛し、
値に適用することができる。
このような機能を含むプログラムの制御の移り変わりは複雑なので、
これを対象にしたステッパ関数の実装は try-with の場合よりも困難である。

\ref{chapter:try-with} 章で示したステッパ関数の実装方法では、
プログラム出力に必要なコンテキスト情報の構造を自分で定義し、
インタプリタに追加して引数で適切にフレームを足していく必要があった。
単純な言語に対するステッパであれば、手動でコンテキストの型を定義するのは簡単だが、
言語が複雑になってくると必ずしもこれは自明ではない。
実際、 \ref{chapter:try-with} 章でのコンテキストは try-with 構文で区切る必要があったため
構造が一次元的でなく、リストのリストになった。
algebraic effects などが入った場合、どのようなコンテキストを使えば良いのかは別途、
考慮する必要がある。
そこで、本研究ではインタプリタを機械的にプログラム変換することで
ステッパおよび必要なコンテキストの構造を導出した。
本章では algebraic effects を含む言語についてこの導出の過程を説明する。

まず \ref{section:definition} 節で algebraic effects を含む言語およびそのインタプリタを定義し、
\ref{section:transform} 節でインタプリタを変換してステッパを得る過程を説明する。
\ref{section:languages} 節では他のいくつかの言語に対するステッパ関数を
同様の変換によって得ることについて議論し、
\ref{section:conclusion} 節でまとめる。

またこの章でのもう1つの貢献として、
algebraic effects の big-step インタプリタを定義した (\ref{subsection:1cps} 節)。
これは、 \ref{chapter:try-with} 章でのステッパ実装と同様に
big-step のインタプリタを元にしてステッパ関数を作成するというアプローチをとったため、
元のインタプリタが必要になったからである。
